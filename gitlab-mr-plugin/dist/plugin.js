!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.GitLabMRPlugin=e():t.GitLabMRPlugin=e()}(self,()=>(()=>{var t={40:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>s});var a=n(601),r=n.n(a),o=n(314),i=n.n(o)()(r());i.push([t.id,"\n.mr-title[data-v-78d12706] {\n  font-size: 14px;\n}\n.mr-iid[data-v-78d12706] {\n  color: #0066ff;\n  font-size: 14px;\n  font-weight: 400;\n  margin-right: 8px;\n}\n.branch-name[data-v-78d12706] {\n  font-size: 14px;\n  font-weight: 400;\n}\n.author-info[data-v-78d12706] {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n}\n.author-avatar[data-v-78d12706] {\n  width: 24px;\n  height: 24px;\n  border-radius: 50%;\n}\n.author-name[data-v-78d12706] {\n  font-size: 13px;\n}\n.mr-meta[data-v-78d12706] {\n  display: flex;\n  gap: 8px;\n  margin-top: 4px;\n  font-size: 12px;\n  color: #666;\n}\n.project-name[data-v-78d12706] {\n  color: #1890ff;\n}\n.mr-id[data-v-78d12706] {\n  color: #999;\n}\n",""]);const s=i},51:(t,e,n)=>{var a=n(80);a.__esModule&&(a=a.default),"string"==typeof a&&(a=[[t.id,a,""]]),a.locals&&(t.exports=a.locals);(0,n(534).A)("2ffc24e0",a,!1,{})},55:(t,e,n)=>{var a=n(188);a.__esModule&&(a=a.default),"string"==typeof a&&(a=[[t.id,a,""]]),a.locals&&(t.exports=a.locals);(0,n(534).A)("a67a0df8",a,!1,{})},80:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>s});var a=n(601),r=n.n(a),o=n(314),i=n.n(o)()(r());i.push([t.id,"\n.el-table {\n  cursor: pointer;\n}\n.el-table__row:hover {\n  background-color: #f5f7fa;\n}\n",""]);const s=i},151:(t,e,n)=>{var a=n(40);a.__esModule&&(a=a.default),"string"==typeof a&&(a=[[t.id,a,""]]),a.locals&&(t.exports=a.locals);(0,n(534).A)("53175b74",a,!1,{})},188:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>s});var a=n(601),r=n.n(a),o=n(314),i=n.n(o)()(r());i.push([t.id,"\n.filter-bar[data-v-2db08777] {\n  display: flex;\n  align-items: center;\n  gap: 20px;\n  padding: 16px 0;\n  border-bottom: 1px solid #ebeef5;\n  margin-bottom: 16px;\n}\n.filter-group[data-v-2db08777] {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n}\n.filter-label[data-v-2db08777] {\n  font-size: 14px;\n  color: #606266;\n  white-space: nowrap;\n}\n\n/* 响应式设计 */\n@media (max-width: 768px) {\n.filter-bar[data-v-2db08777] {\n    flex-direction: column;\n    align-items: stretch;\n}\n.filter-group[data-v-2db08777] {\n    justify-content: space-between;\n}\n.filter-bar .el-select[data-v-2db08777] {\n    width: 100%;\n}\n}\n",""]);const s=i},243:(t,e,n)=>{var a=n(658);a.__esModule&&(a=a.default),"string"==typeof a&&(a=[[t.id,a,""]]),a.locals&&(t.exports=a.locals);(0,n(534).A)("83ac2ec6",a,!1,{})},314:t=>{"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map(function(e){var n="",a=void 0!==e[5];return e[4]&&(n+="@supports (".concat(e[4],") {")),e[2]&&(n+="@media ".concat(e[2]," {")),a&&(n+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),n+=t(e),a&&(n+="}"),e[2]&&(n+="}"),e[4]&&(n+="}"),n}).join("")},e.i=function(t,n,a,r,o){"string"==typeof t&&(t=[[null,t,void 0]]);var i={};if(a)for(var s=0;s<this.length;s++){var l=this[s][0];null!=l&&(i[l]=!0)}for(var c=0;c<t.length;c++){var u=[].concat(t[c]);a&&i[u[0]]||(void 0!==o&&(void 0===u[5]||(u[1]="@layer".concat(u[5].length>0?" ".concat(u[5]):""," {").concat(u[1],"}")),u[5]=o),n&&(u[2]?(u[1]="@media ".concat(u[2]," {").concat(u[1],"}"),u[2]=n):u[2]=n),r&&(u[4]?(u[1]="@supports (".concat(u[4],") {").concat(u[1],"}"),u[4]=r):u[4]="".concat(r)),e.push(u))}},e}},317:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>s});var a=n(601),r=n.n(a),o=n(314),i=n.n(o)()(r());i.push([t.id,"\n.gitlab-mr-plugin[data-v-90a5cf84] {\n  padding: 20px;\n  background: #fff;\n  height: 100%;\n  font-size: 14px;\n}\n.plugin-header[data-v-90a5cf84] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 24px;\n  padding-bottom: 16px;\n  border-bottom: 1px solid #e8e8e8;\n}\n.plugin-header h2[data-v-90a5cf84] {\n  margin: 0;\n  color: #333;\n  font-size: 20px;\n  font-weight: 500;\n}\n.header-actions[data-v-90a5cf84] {\n  display: flex;\n  gap: 8px;\n}\n.config-prompt[data-v-90a5cf84] {\n  text-align: center;\n  padding: 40px 20px;\n}\n.config-prompt-title[data-v-90a5cf84] {\n  font-size: 16px;\n  font-weight: 500;\n  color: #333;\n}\n.config-prompt-desc[data-v-90a5cf84] {\n  font-size: 14px;\n  color: #666;\n}\n.pagination-wrapper[data-v-90a5cf84] {\n  margin-top: 16px;\n  text-align: center;\n}\n.empty-state[data-v-90a5cf84] {\n  text-align: center;\n  padding: 60px 20px;\n  color: #999;\n}\n.empty-state i[data-v-90a5cf84] {\n  font-size: 48px;\n  margin-bottom: 16px;\n  display: block;\n}\n.empty-state p[data-v-90a5cf84] {\n  margin: 0;\n  font-size: 14px;\n}\n\n/* 响应式设计 */\n@media (max-width: 768px) {\n.gitlab-mr-plugin[data-v-90a5cf84] {\n    padding: 12px;\n}\n.plugin-header[data-v-90a5cf84] {\n    flex-direction: column;\n    gap: 12px;\n    align-items: flex-start;\n}\n}\n",""]);const s=i},534:(t,e,n)=>{"use strict";function a(t,e){for(var n=[],a={},r=0;r<e.length;r++){var o=e[r],i=o[0],s={id:t+":"+r,css:o[1],media:o[2],sourceMap:o[3]};a[i]?a[i].parts.push(s):n.push(a[i]={id:i,parts:[s]})}return n}n.d(e,{A:()=>g});var r="undefined"!=typeof document;if("undefined"!=typeof DEBUG&&DEBUG&&!r)throw new Error("vue-style-loader cannot be used in a non-browser environment. Use { target: 'node' } in your Webpack config to indicate a server-rendering environment.");var o={},i=r&&(document.head||document.getElementsByTagName("head")[0]),s=null,l=0,c=!1,u=function(){},f=null,p="data-vue-ssr-id",d="undefined"!=typeof navigator&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase());function g(t,e,n,r){c=n,f=r||{};var i=a(t,e);return h(i),function(e){for(var n=[],r=0;r<i.length;r++){var s=i[r];(l=o[s.id]).refs--,n.push(l)}e?h(i=a(t,e)):i=[];for(r=0;r<n.length;r++){var l;if(0===(l=n[r]).refs){for(var c=0;c<l.parts.length;c++)l.parts[c]();delete o[l.id]}}}}function h(t){for(var e=0;e<t.length;e++){var n=t[e],a=o[n.id];if(a){a.refs++;for(var r=0;r<a.parts.length;r++)a.parts[r](n.parts[r]);for(;r<n.parts.length;r++)a.parts.push(m(n.parts[r]));a.parts.length>n.parts.length&&(a.parts.length=n.parts.length)}else{var i=[];for(r=0;r<n.parts.length;r++)i.push(m(n.parts[r]));o[n.id]={id:n.id,refs:1,parts:i}}}}function v(){var t=document.createElement("style");return t.type="text/css",i.appendChild(t),t}function m(t){var e,n,a=document.querySelector("style["+p+'~="'+t.id+'"]');if(a){if(c)return u;a.parentNode.removeChild(a)}if(d){var r=l++;a=s||(s=v()),e=_.bind(null,a,r,!1),n=_.bind(null,a,r,!0)}else a=v(),e=w.bind(null,a),n=function(){a.parentNode.removeChild(a)};return e(t),function(a){if(a){if(a.css===t.css&&a.media===t.media&&a.sourceMap===t.sourceMap)return;e(t=a)}else n()}}var b,y=(b=[],function(t,e){return b[t]=e,b.filter(Boolean).join("\n")});function _(t,e,n,a){var r=n?"":a.css;if(t.styleSheet)t.styleSheet.cssText=y(e,r);else{var o=document.createTextNode(r),i=t.childNodes;i[e]&&t.removeChild(i[e]),i.length?t.insertBefore(o,i[e]):t.appendChild(o)}}function w(t,e){var n=e.css,a=e.media,r=e.sourceMap;if(a&&t.setAttribute("media",a),f.ssrId&&t.setAttribute(p,e.id),r&&(n+="\n/*# sourceURL="+r.sources[0]+" */",n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(r))))+" */"),t.styleSheet)t.styleSheet.cssText=n;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(n))}}},601:t=>{"use strict";t.exports=function(t){return t[1]}},658:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>s});var a=n(601),r=n.n(a),o=n(314),i=n.n(o)()(r());i.push([t.id,"\n.form-help[data-v-1b209afa] {\n  margin-top: 8px;\n  font-size: 12px;\n  color: #666;\n  line-height: 1.4;\n}\n.form-help p[data-v-1b209afa] {\n  margin: 4px 0;\n}\n.form-help ul[data-v-1b209afa] {\n  margin: 4px 0;\n  padding-left: 16px;\n  list-style: disc;\n}\n.form-help li[data-v-1b209afa] {\n  margin: 2px 0;\n}\n.form-help a[data-v-1b209afa] {\n  color: #06f;\n  text-decoration: none;\n  font-size: 11px;\n}\n.form-help a[data-v-1b209afa]:hover {\n  text-decoration: underline;\n}\n.dialog-footer[data-v-1b209afa] {\n  text-align: right;\n}\n.dialog-footer .el-button + .el-button[data-v-1b209afa] {\n  margin-left: 10px;\n}\n",""]);const s=i},936:(t,e,n)=>{var a=n(317);a.__esModule&&(a=a.default),"string"==typeof a&&(a=[[t.id,a,""]]),a.locals&&(t.exports=a.locals);(0,n(534).A)("4bb2d255",a,!1,{})}},e={};function n(a){var r=e[a];if(void 0!==r)return r.exports;var o=e[a]={id:a,exports:{}};return t[a](o,o.exports,n),o.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var a in e)n.o(e,a)&&!n.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:e[a]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var a={};return(()=>{"use strict";n.d(a,{default:()=>U});var t=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"gitlab-mr-plugin"},[n("div",{staticClass:"plugin-header"},[n("h2",[t._v("GitLab Merge Requests")]),t._v(" "),n("div",{staticClass:"header-actions"},[n("el-button",{attrs:{size:"small",icon:"el-icon-setting"},on:{click:function(e){t.showTokenDialog=!0}}},[t._v("\n        配置\n      ")]),t._v(" "),n("el-button",{attrs:{size:"small",icon:"el-icon-refresh",loading:t.loading},on:{click:t.handleRefresh}},[t._v("\n        刷新\n      ")])],1)]),t._v(" "),n("ConfigDialog",{attrs:{visible:t.showTokenDialog,"gitlab-url":t.gitlabUrl,"gitlab-token":t.gitlabToken},on:{"update:visible":function(e){t.showTokenDialog=e},"update:gitlabUrl":function(e){t.gitlabUrl=e},"update:gitlab-url":function(e){t.gitlabUrl=e},"update:gitlabToken":function(e){t.gitlabToken=e},"update:gitlab-token":function(e){t.gitlabToken=e},save:t.saveConfig,test:t.testConnection,clear:t.clearConfig}}),t._v(" "),t.isConfigured?n("div",[n("FilterBar",{attrs:{"state-options":t.stateOptions,"scope-options":t.scopeOptions,"filter-state":t.filterState,"filter-scope":t.filterScope},on:{"update:filterState":function(e){t.filterState=e},"update:filter-state":function(e){t.filterState=e},"update:filterScope":function(e){t.filterScope=e},"update:filter-scope":function(e){t.filterScope=e},change:t.handleFilterChange}}),t._v(" "),t.error?n("el-alert",{staticStyle:{"margin-bottom":"16px"},attrs:{title:t.error,type:"error",closable:!1}}):t._e(),t._v(" "),n("MRTable",{attrs:{data:t.mergeRequests,loading:t.loading},on:{"row-click":t.openMR}}),t._v(" "),t.total>t.pageSize?n("div",{staticClass:"pagination-wrapper"},[n("el-pagination",{attrs:{"current-page":t.currentPage,"page-size":t.pageSize,total:t.total,layout:"prev, pager, next, total",small:""},on:{"current-change":t.handlePageChange}})],1):t._e(),t._v(" "),t.loading||0!==t.mergeRequests.length?t._e():n("div",{staticClass:"empty-state"},[n("i",{staticClass:"el-icon-document"}),t._v(" "),n("p",[t._v("暂无 Merge Request")])])],1):n("div",{staticClass:"config-prompt"},[n("p",{staticClass:"config-prompt-title"},[t._v("需要配置 GitLab 信息")]),t._v(" "),n("p",{staticClass:"config-prompt-desc"},[t._v("请先配置 GitLab URL 和 Access Token 才能查看 Merge Request")]),t._v(" "),n("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(e){t.showTokenDialog=!0}}},[t._v("\n      立即配置\n    ")])],1)],1)};t._withStripped=!0;var e=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-dialog",{attrs:{title:"GitLab 配置",visible:t.dialogVisible,width:"500px","close-on-click-modal":!1},on:{"update:visible":function(e){t.dialogVisible=e}}},[n("el-form",{attrs:{model:t.form,"label-position":"left","label-width":"120px"}},[n("el-form-item",{attrs:{label:"GitLab URL"}},[n("el-input",{attrs:{placeholder:"例如: https://gitlab.com 或 https://gitlab.example.com",size:"small"},model:{value:t.form.gitlabUrl,callback:function(e){t.$set(t.form,"gitlabUrl",e)},expression:"form.gitlabUrl"}})],1),t._v(" "),n("el-form-item",{attrs:{label:"Access Token"}},[n("el-input",{attrs:{type:"password",placeholder:"输入 GitLab Access Token","show-password":"",size:"small"},model:{value:t.form.gitlabToken,callback:function(e){t.$set(t.form,"gitlabToken",e)},expression:"form.gitlabToken"}}),t._v(" "),n("div",{staticClass:"form-help"},[n("p",[t._v("Token需要以下权限:")]),t._v(" "),n("ul",[n("li",[t._v("api - 访问 API")]),t._v(" "),n("li",[t._v("read_user - 读取用户信息")])]),t._v(" "),n("p",[n("a",{attrs:{href:"https://gitlab.com/-/profile/personal_access_tokens",target:"_blank"}},[t._v("\n            在 GitLab.com 创建 Token\n          ")])])])],1)],1),t._v(" "),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{size:"small",type:"danger",plain:""},on:{click:t.handleClear}},[t._v("清除配置")]),t._v(" "),n("el-button",{attrs:{size:"small",loading:t.testing},on:{click:t.handleTest}},[t._v("测试连接")]),t._v(" "),n("el-button",{attrs:{size:"small",type:"primary"},on:{click:t.handleSave}},[t._v("保存")]),t._v(" "),n("el-button",{attrs:{size:"small"},on:{click:function(e){t.dialogVisible=!1}}},[t._v("取消")])],1)],1)};e._withStripped=!0;const r={name:"ConfigDialog",props:{visible:{type:Boolean,default:!1},gitlabUrl:{type:String,default:""},gitlabToken:{type:String,default:""}},data:function(){return{testing:!1,form:{gitlabUrl:"",gitlabToken:""}}},computed:{dialogVisible:{get:function(){return this.visible},set:function(t){this.$emit("update:visible",t)}}},watch:{visible:function(t){t&&(this.form.gitlabUrl=this.gitlabUrl,this.form.gitlabToken=this.gitlabToken)}},methods:{handleSave:function(){this.$emit("update:gitlab-url",this.form.gitlabUrl),this.$emit("update:gitlab-token",this.form.gitlabToken),this.$emit("save")},handleTest:function(){this.$emit("update:gitlab-url",this.form.gitlabUrl),this.$emit("update:gitlab-token",this.form.gitlabToken),this.$emit("test")},handleClear:function(){this.$emit("clear")}}};n(243);function o(t,e,n,a,r,o,i,s){var l,c="function"==typeof t?t.options:t;if(e&&(c.render=e,c.staticRenderFns=n,c._compiled=!0),a&&(c.functional=!0),o&&(c._scopeId="data-v-"+o),i?(l=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),r&&r.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(i)},c._ssrRegister=l):r&&(l=s?function(){r.call(this,(c.functional?this.parent:this).$root.$options.shadowRoot)}:r),l)if(c.functional){c._injectStyles=l;var u=c.render;c.render=function(t,e){return l.call(e),u(t,e)}}else{var f=c.beforeCreate;c.beforeCreate=f?[].concat(f,l):[l]}return{exports:t,options:c}}const i=o(r,e,[],!1,null,"1b209afa",null).exports;var s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"filter-bar"},[n("div",{staticClass:"filter-group"},[n("label",{staticClass:"filter-label"},[t._v("状态:")]),t._v(" "),n("el-select",{staticStyle:{width:"120px"},attrs:{value:t.filterState,size:"small"},on:{input:t.handleStateChange}},t._l(t.stateOptions,function(t){return n("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)],1),t._v(" "),n("div",{staticClass:"filter-group"},[n("label",{staticClass:"filter-label"},[t._v("范围:")]),t._v(" "),n("el-select",{staticStyle:{width:"140px"},attrs:{value:t.filterScope,size:"small"},on:{input:t.handleScopeChange}},t._l(t.scopeOptions,function(t){return n("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)],1)])};s._withStripped=!0;const l={name:"FilterBar",props:{stateOptions:{type:Array,default:function(){return[]}},scopeOptions:{type:Array,default:function(){return[]}},filterState:{type:String,default:"opened"},filterScope:{type:String,default:"assigned_to_me"}},methods:{handleStateChange:function(t){this.$emit("update:filter-state",t),this.$emit("change")},handleScopeChange:function(t){this.$emit("update:filter-scope",t),this.$emit("change")}}};n(55);const c=o(l,s,[],!1,null,"2db08777",null).exports;var u=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-table",{staticStyle:{width:"100%"},attrs:{data:t.data,loading:t.loading,stripe:""},on:{"row-click":t.handleRowClick}},[n("el-table-column",{attrs:{prop:"title",label:"标题","min-width":"300"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("div",{staticClass:"mr-title"},[n("span",{staticClass:"mr-iid"},[t._v("#"+t._s(e.row.iid))]),t._v(" "),n("span",{staticClass:"title-text"},[t._v(t._s(e.row.title))])])]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"源分支"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",{staticClass:"branch-name"},[t._v(t._s(e.row.source_branch))])]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"目标分支"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",{staticClass:"branch-name"},[t._v(t._s(e.row.target_branch))])]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"作者"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("div",{staticClass:"author-info"},[e.row.author.avatar_url?n("img",{staticClass:"author-avatar",attrs:{src:e.row.author.avatar_url,alt:e.row.author.name}}):t._e(),t._v(" "),n("span",{staticClass:"author-name"},[t._v(t._s(e.row.author.name))])])]}}])}),t._v(" "),n("el-table-column",{attrs:{prop:"state",label:"状态",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-tag",{attrs:{type:t.getStateType(e.row.state),size:"small"}},[t._v("\n        "+t._s(t.getStateText(e.row.state))+"\n      ")])]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"创建时间",width:"160"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n      "+t._s(t.formatDate(e.row.created_at))+"\n    ")]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"更新时间",width:"160"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n      "+t._s(t.formatDate(e.row.updated_at))+"\n    ")]}}])})],1)};u._withStripped=!0;const f={name:"MRTable",props:{data:{type:Array,default:function(){return[]}},loading:{type:Boolean,default:!1}},methods:{handleRowClick:function(t){this.$emit("row-click",t)},formatDate:function(t){return t?new Date(t).toLocaleString("zh-CN"):"-"},getStateText:function(t){return{opened:"已打开",closed:"已关闭",merged:"已合并"}[t]||t},getStateType:function(t){return{opened:"primary",closed:"info",merged:"success"}[t]||"default"}}};n(151),n(51);function p(){var t,e,n="function"==typeof Symbol?Symbol:{},a=n.iterator||"@@iterator",r=n.toStringTag||"@@toStringTag";function o(n,a,r,o){var l=a&&a.prototype instanceof s?a:s,c=Object.create(l.prototype);return d(c,"_invoke",function(n,a,r){var o,s,l,c=0,u=r||[],f=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return o=e,s=0,l=t,p.n=n,i}};function d(n,a){for(s=n,l=a,e=0;!f&&c&&!r&&e<u.length;e++){var r,o=u[e],d=p.p,g=o[2];n>3?(r=g===a)&&(l=o[(s=o[4])?5:(s=3,3)],o[4]=o[5]=t):o[0]<=d&&((r=n<2&&d<o[1])?(s=0,p.v=a,p.n=o[1]):d<g&&(r=n<3||o[0]>a||a>g)&&(o[4]=n,o[5]=a,p.n=g,s=0))}if(r||n>1)return i;throw f=!0,a}return function(r,u,g){if(c>1)throw TypeError("Generator is already running");for(f&&1===u&&d(u,g),s=u,l=g;(e=s<2?t:l)||!f;){o||(s?s<3?(s>1&&(p.n=-1),d(s,l)):p.n=l:p.v=l);try{if(c=2,o){if(s||(r="next"),e=o[r]){if(!(e=e.call(o,l)))throw TypeError("iterator result is not an object");if(!e.done)return e;l=e.value,s<2&&(s=0)}else 1===s&&(e=o.return)&&e.call(o),s<2&&(l=TypeError("The iterator does not provide a '"+r+"' method"),s=1);o=t}else if((e=(f=p.n<0)?l:n.call(a,p))!==i)break}catch(e){o=t,s=1,l=e}finally{c=1}}return{value:e,done:f}}}(n,r,o),!0),c}var i={};function s(){}function l(){}function c(){}e=Object.getPrototypeOf;var u=[][a]?e(e([][a]())):(d(e={},a,function(){return this}),e),f=c.prototype=s.prototype=Object.create(u);function g(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,c):(t.__proto__=c,d(t,r,"GeneratorFunction")),t.prototype=Object.create(f),t}return l.prototype=c,d(f,"constructor",c),d(c,"constructor",l),l.displayName="GeneratorFunction",d(c,r,"GeneratorFunction"),d(f),d(f,r,"Generator"),d(f,a,function(){return this}),d(f,"toString",function(){return"[object Generator]"}),(p=function(){return{w:o,m:g}})()}function d(t,e,n,a){var r=Object.defineProperty;try{r({},"",{})}catch(t){r=0}d=function(t,e,n,a){function o(e,n){d(t,e,function(t){return this._invoke(e,n,t)})}e?r?r(t,e,{value:n,enumerable:!a,configurable:!a,writable:!a}):t[e]=n:(o("next",0),o("throw",1),o("return",2))},d(t,e,n,a)}function g(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var a,r,o,i,s=[],l=!0,c=!1;try{if(o=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;l=!1}else for(;!(l=(a=o.call(n)).done)&&(s.push(a.value),s.length!==e);l=!0);}catch(t){c=!0,r=t}finally{try{if(!l&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(c)throw r}}return s}}(t,e)||function(t,e){if(t){if("string"==typeof t)return h(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?h(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=Array(e);n<e;n++)a[n]=t[n];return a}function v(t,e,n,a,r,o,i){try{var s=t[o](i),l=s.value}catch(t){return void n(t)}s.done?e(l):Promise.resolve(l).then(a,r)}function m(t){return function(){var e=this,n=arguments;return new Promise(function(a,r){var o=t.apply(e,n);function i(t){v(o,a,r,i,s,"next",t)}function s(t){v(o,a,r,i,s,"throw",t)}i(void 0)})}}const b={name:"GitLabMRMain",components:{ConfigDialog:i,FilterBar:c,MRTable:o(f,u,[],!1,null,"78d12706",null).exports},props:{storage:{type:Object,required:!0}},data:function(){return{gitlabToken:"",gitlabUrl:"",showTokenDialog:!1,mergeRequests:[],loading:!1,error:null,currentPage:1,pageSize:20,total:0,filterState:"opened",filterScope:"assigned_to_me"}},computed:{isConfigured:function(){return this.gitlabToken&&this.gitlabUrl},stateOptions:function(){return[{label:"已打开",value:"opened"},{label:"已关闭",value:"closed"},{label:"已合并",value:"merged"},{label:"全部",value:"all"}]},scopeOptions:function(){return[{label:"分配给我",value:"assigned_to_me"},{label:"我创建的",value:"created_by_me"},{label:"全部",value:"all"}]}},mounted:function(){this.loadConfig(),this.isConfigured&&this.fetchMergeRequests()},methods:{loadConfig:function(){this.storage?(this.gitlabToken=this.storage.get("gitlab_token")||"",this.gitlabUrl=this.storage.get("gitlab_url")||"https://gitlab.com"):console.error("Storage not available in loadConfig")},saveConfig:function(){if(!this.storage)return console.error("Storage not available in saveConfig"),void this.$message.error("存储服务不可用");this.gitlabToken&&this.gitlabUrl?(this.storage.set("gitlab_token",this.gitlabToken),this.storage.set("gitlab_url",this.gitlabUrl),this.showTokenDialog=!1,this.$message.success("配置已保存"),this.fetchMergeRequests()):this.$message.error("请填写完整的 GitLab 配置")},clearConfig:function(){var t=this;if(!this.storage)return console.error("Storage not available in clearConfig"),void this.$message.error("存储服务不可用");this.$confirm("确定要清除 GitLab 配置吗？","确认",{type:"warning"}).then(function(){t.storage.remove("gitlab_token"),t.storage.remove("gitlab_url"),t.gitlabToken="",t.gitlabUrl="",t.mergeRequests=[],t.$message.success("配置已清除")}).catch(function(){})},fetchMergeRequests:function(){var t=this;return m(p().m(function e(){var n,a,r,o,i;return p().w(function(e){for(;;)switch(e.p=e.n){case 0:if(t.isConfigured){e.n=1;break}return t.showTokenDialog=!0,e.a(2);case 1:return t.loading=!0,t.error=null,e.p=2,n=new URLSearchParams({state:"all"===t.filterState?void 0:t.filterState,scope:"all"===t.filterScope?void 0:t.filterScope,page:t.currentPage,per_page:t.pageSize,sort:"desc"}),Array.from(n.entries()).forEach(function(t){var e=g(t,2),a=e[0],r=e[1];"undefined"!==r&&void 0!==r||n.delete(a)}),e.n=3,fetch("".concat(t.gitlabUrl,"/api/v4/merge_requests?").concat(n),{headers:{Authorization:"Bearer ".concat(t.gitlabToken),"Content-Type":"application/json"}});case 3:if((a=e.v).ok){e.n=6;break}if(401!==a.status){e.n=4;break}throw new Error("Token 无效或已过期");case 4:if(403!==a.status){e.n=5;break}throw new Error("Token 权限不足，需要 api 和 read_user 权限");case 5:throw new Error("HTTP ".concat(a.status,": ").concat(a.statusText));case 6:return e.n=7,a.json();case 7:r=e.v,t.mergeRequests=r,o=a.headers.get("X-Total"),t.total=o?parseInt(o):r.length,e.n=9;break;case 8:e.p=8,i=e.v,console.error("获取 MR 失败:",i),t.error=i.message,"TypeError"===i.name&&i.message.includes("fetch")?t.$message.error("网络连接失败，请检查 GitLab URL 是否正确"):t.$message.error("获取Merge Request失败: ".concat(i.message));case 9:return e.p=9,t.loading=!1,e.f(9);case 10:return e.a(2)}},e,null,[[2,8,9,10]])}))()},handleRefresh:function(){this.currentPage=1,this.fetchMergeRequests()},handleFilterChange:function(){this.currentPage=1,this.fetchMergeRequests()},handlePageChange:function(t){this.currentPage=t,this.fetchMergeRequests()},openMR:function(t){window.open(t.web_url,"_blank")},testConnection:function(){var t=this;return m(p().m(function e(){var n,a,r,o;return p().w(function(e){for(;;)switch(e.p=e.n){case 0:if(t.gitlabToken&&t.gitlabUrl){e.n=1;break}return t.$message.error("请填写完整的 GitLab 配置"),e.a(2);case 1:return n=t.$loading({text:"正在测试连接..."}),e.p=2,e.n=3,fetch("".concat(t.gitlabUrl,"/api/v4/user"),{headers:{Authorization:"Bearer ".concat(t.gitlabToken),"Content-Type":"application/json"}});case 3:if((a=e.v).ok){e.n=6;break}if(401!==a.status){e.n=4;break}throw new Error("Token 无效或已过期");case 4:if(403!==a.status){e.n=5;break}throw new Error("Token 权限不足，需要 api 和 read_user 权限");case 5:throw new Error("HTTP ".concat(a.status,": ").concat(a.statusText));case 6:return e.n=7,a.json();case 7:r=e.v,t.$message.success("连接成功！当前用户: ".concat(r.name," (@").concat(r.username,")")),e.n=9;break;case 8:e.p=8,o=e.v,console.error("连接测试失败:",o),"TypeError"===o.name&&o.message.includes("fetch")?t.$message.error("网络连接失败，请检查 GitLab URL 是否正确"):t.$message.error("连接失败: ".concat(o.message));case 9:return e.p=9,n.close(),e.f(9);case 10:return e.a(2)}},e,null,[[2,8,9,10]])}))()}}};n(936);const y=o(b,t,[],!1,null,"90a5cf84",null).exports;function _(t){return _="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_(t)}function w(t,e,n){return e=x(e),function(t,e){if(e&&("object"==_(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,k()?Reflect.construct(e,n||[],x(t).constructor):e.apply(t,n))}function k(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(k=function(){return!!t})()}function x(t){return x=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},x(t)}function S(t,e){return S=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},S(t,e)}function C(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function T(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,O(a.key),a)}}function R(t,e,n){return e&&T(t.prototype,e),n&&T(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function O(t){var e=function(t,e){if("object"!=_(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var a=n.call(t,e||"default");if("object"!=_(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==_(e)?e:e+""}var j=window.ZadigPlugin||function(){return R(function t(e){C(this,t),this.manifest=e,this.id=e.id,this.name=e.name,this.version=e.version,this.type=e.type,this._mounted=!1,this._destroyed=!1,this.api=null},[{key:"onCreate",value:function(){}},{key:"onMount",value:function(){}},{key:"onUnmount",value:function(){}},{key:"onDestroy",value:function(){}},{key:"onUpdate",value:function(t){}},{key:"_create",value:function(t){this.api=t,this.onCreate()}},{key:"_mount",value:function(){this._mounted=!0,this.onMount()}},{key:"_unmount",value:function(){this._mounted=!1,this.onUnmount()}},{key:"_destroy",value:function(){this._destroyed=!0,this.onDestroy()}},{key:"registerRoute",value:function(t){if(this.api&&this.api.registerRoute)return this.api.registerRoute(t);console.log("[".concat(this.name,"] 注册路由:"),t)}},{key:"registerComponent",value:function(t,e){if(this.api&&this.api.registerComponent)return this.api.registerComponent(t,e,this.id);console.log("[".concat(this.name,"] 注册组件:"),t)}},{key:"getState",value:function(){return{id:this.id,name:this.name,version:this.version,type:this.type,mounted:this._mounted,destroyed:this._destroyed}}},{key:"hasPermission",value:function(t){return this.manifest.permissions&&this.manifest.permissions.includes(t)}},{key:"on",value:function(){}},{key:"off",value:function(){}},{key:"emit",value:function(){}}])}(),M=function(t){function e(t){var n;return C(this,e),(n=w(this,e,[t||e.defaultManifest])).storage=null,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&S(t,e)}(e,t),R(e,[{key:"onCreate",value:function(){console.log("".concat(this.name," plugin created"))}},{key:"onMount",value:function(){console.log("".concat(this.name," plugin mounted")),this.storage=this.getPluginStorage(),this.initStorage();var t=this,e="GitLabWrapper_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9)),n={name:"GitLabMRWrapper_".concat(e),_pluginId:this.id,_componentId:e,render:function(n){return console.log("[GitLab] Rendering component: ".concat(e)),n(y,{props:{storage:t.storage}})},created:function(){console.log("[GitLab] Component created: ".concat(e))},mounted:function(){console.log("[GitLab] Component mounted: ".concat(e))}};console.log("[GitLab] Created wrapper component with ID: ".concat(e)),this.component=n,this.registerRoute({path:"/",component:n,meta:{title:"GitLab Merge Requests",icon:"el-icon-s-cooperation"}})}},{key:"onUnmount",value:function(){console.log("".concat(this.name," plugin unmounted"))}},{key:"onDestroy",value:function(){console.log("".concat(this.name," plugin destroyed")),this.storage}},{key:"getPluginStorage",value:function(){return this.api&&this.api.getStorage?this.api.getStorage():{data:{},get:function(t){try{var e=localStorage.getItem("plugin_".concat(t));return e?JSON.parse(e):void 0}catch(t){return}},set:function(t,e){try{return localStorage.setItem("plugin_".concat(t),JSON.stringify(e)),!0}catch(t){return!1}},remove:function(t){try{return localStorage.removeItem("plugin_".concat(t)),!0}catch(t){return!1}}}}},{key:"initStorage",value:function(){this.storage&&(this.storage.get("config")||this.storage.set("config",{gitlabUrl:"https://gitlab.com",autoRefresh:!0,pageSize:20}))}},{key:"getConfig",value:function(){return this.storage&&this.storage.get("config")||{}}},{key:"saveConfig",value:function(t){this.storage&&this.storage.set("config",t)}},{key:"getComponent",value:function(){return this.component}}])}(j);M.defaultManifest={identifier:"gitlab-mr-plugin",name:"GitLab MR查看器",version:"1.0.0",description:"查看分配给我的GitLab Merge Request",author:"Zadig Team",type:"page",entry:"./index.js",icon:"el-icon-s-cooperation",route:"/gitlab-mr",permissions:["api.external.gitlab"]},window.__zadig_plugin_gitlab_mr_plugin&&window.__zadig_plugin_gitlab_mr_plugin.register(M);const U=M})(),a=a.default})());